---
title: Qt中的宏
author: 齐兆龙
date: 2025-09-20
category: Qt
layout: post
---

---

# Qt 和 C++ 常用宏参考表

| 宏名称 | 作用描述 | 使用示例 |
|--------|----------|----------|
| Q_OBJECT | Qt 元对象系统的核心宏，用于启用信号槽、属性等功能 | class MyClass : public QObject { Q_OBJECT }; |
| signals | 声明信号函数，信号不需要实现 | signals: void valueChanged(int newValue); |
| slots | 声明槽函数，槽函数需要具体实现 | public slots: void setValue(int value); |
| Q_PROPERTY | 声明属性，用于元对象系统 | Q_PROPERTY(QString name READ name WRITE setName NOTIFY nameChanged) |
| Q_INVOKABLE | 标记成员函数可通过元对象系统调用 | Q_INVOKABLE void calculate(); |
| Q_DECL_OVERRIDE | 标记重写虚函数（C++11 override） | void paint() Q_DECL_OVERRIDE; |
| Q_DECL_FINAL | 标记类或虚函数为final（不可继承/重写） | class MyClass Q_DECL_FINAL; |
| Q_DECL_EXPORT | 声明导出符号（Windows DLL导出） | class Q_DECL_EXPORT MyLibraryClass; |
| Q_DECL_IMPORT | 声明导入符号（Windows DLL导入） | class Q_DECL_IMPORT ExternalLibraryClass; |
| QT_BEGIN_NAMESPACE | 开始Qt命名空间 | QT_BEGIN_NAMESPACE |
| QT_END_NAMESPACE | 结束Qt命名空间 | QT_END_NAMESPACE |
| Q_UNUSED | 标记未使用的参数，避免编译器警告 | void func(int param) { Q_UNUSED(param); } |
| Q_ASSERT | 运行时断言，失败时输出错误信息 | Q_ASSERT(pointer != nullptr); |
| Q_CHECK_PTR | 检查指针是否为空，为空时终止程序 | Q_CHECK_PTR(allocatedMemory); |
| qDebug | 输出调试信息 | qDebug() << "Value:" << value; |
| qWarning | 输出警告信息 | qWarning() << "Unexpected value"; |
| qCritical | 输出严重错误信息 | qCritical() << "Critical error occurred"; |
| qFatal | 输出致命错误信息并终止程序 | qFatal("Application cannot continue"); |
| QT_VERSION | Qt编译时版本号 | #if QT_VERSION >= 0x050000 |
| QT_VERSION_CHECK | 创建Qt版本号用于比较 | #if QT_VERSION >= QT_VERSION_CHECK(5, 15, 0) |
| Q_NULLPTR | 空指针常量（C++11 nullptr） | QString* str = Q_NULLPTR; |
| foreach | Qt的foreach循环宏 | foreach (const QString &str, stringList) |
| Q_DISABLE_COPY | 禁用类的拷贝构造函数和赋值运算符 | class MyClass { Q_DISABLE_COPY(MyClass) }; |
| Q_D | 访问d指针（PIMPL惯用法） | Q_D(const MyClass); |
| Q_Q | 访问q指针（PIMPL惯用法） | Q_Q(MyClass); |
| QT_TR_NOOP | 标记需要翻译的字符串（不立即翻译） | const char* text = QT_TR_NOOP("Hello World"); |
| QT_TRANSLATE_NOOP | 标记需要翻译的字符串（指定上下文） | const char* text = QT_TRANSLATE_NOOP("MainWindow", "Save"); |
| SLOT() | 将方法名转换为槽函数签名字符串 | connect(btn, SIGNAL(clicked()), this, SLOT(handleClick())); |
| SIGNAL() | 将信号名转换为信号签名字符串 | connect(btn, SIGNAL(clicked()), this, SLOT(handleClick())); |
| Q_EMIT | 发射信号（与emit相同） | Q_EMIT valueChanged(newValue); |
| Q_FOREACH | 与foreach相同 | Q_FOREACH (const QString &str, stringList) |
| Q_DECLARE_METATYPE | 声明类型可用于QVariant和信号槽 | Q_DECLARE_METATYPE(MyCustomType) |
| Q_ENUM | 声明枚举可用于元对象系统 | Q_ENUM(MyEnum) |
| Q_FLAG | 声明标志枚举可用于元对象系统 | Q_FLAG(MyFlags) |
| Q_GLOBAL_STATIC | 创建线程安全的全局静态对象 | Q_GLOBAL_STATIC(MyClass, globalInstance) |
| Q_OS_WIN | 判断Windows平台 | #ifdef Q_OS_WIN |
| Q_OS_LINUX | 判断Linux平台 | #ifdef Q_OS_LINUX |
| Q_OS_MAC | 判断macOS平台 | #ifdef Q_OS_MAC |
| Q_CC_MSVC | 判断MSVC编译器 | #ifdef Q_CC_MSVC |
| Q_CC_GNU | 判断GCC编译器 | #ifdef Q_CC_GNU |
| Q_DECL_CONSTEXPR | 声明常量表达式（C++11 constexpr） | Q_DECL_CONSTEXPR int maxSize() { return 100; } |
| Q_DECL_NOEXCEPT | 声明函数不抛出异常（C++11 noexcept） | void func() Q_DECL_NOEXCEPT; |
| QT_REQUIRE_VERSION | 检查Qt版本是否符合要求 | QT_REQUIRE_VERSION(argc, argv, "5.15.0") |
| Q_UNREACHABLE | 标记代码不应该执行到的位置 | Q_UNREACHABLE(); |
| Q_ASSUME | 向编译器提供优化假设 | Q_ASSUME(ptr != nullptr); |
| Q_FALLTHROUGH | 标记switch case的fallthrough行为 | Q_FALLTHROUGH(); |
| Q_LIKELY | 提示条件很可能为真 | if (Q_LIKELY(condition)) |
| Q_UNLIKELY | 提示条件很可能为假 | if (Q_UNLIKELY(condition)) |
| QT_NO_CAST_FROM_ASCII | 禁用从char*到QString的隐式转换 | #define QT_NO_CAST_FROM_ASCII |
| QT_NO_CAST_TO_ASCII | 禁用从QString到char*的隐式转换 | #define QT_NO_CAST_TO_ASCII |
| QT_NO_KEYWORDS | 禁用Qt关键字（使用Q_前缀版本） | #define QT_NO_KEYWORDS |
| Q_MOC_RUN | 标识代码由moc处理 | #ifdef Q_MOC_RUN |
| Q_CORE_EXPORT | 核心模块导出宏 | class Q_CORE_EXPORT QObject; |
| Q_GUI_EXPORT | GUI模块导出宏 | class Q_GUI_EXPORT QWidget; |
| Q_WIDGETS_EXPORT | Widgets模块导出宏 | class Q_WIDGETS_EXPORT QMainWindow; |
| Q_DECLARE_INTERFACE | 声明Qt插件接口 | Q_DECLARE_INTERFACE(MyInterface, "com.example.MyInterface") |
| Q_INTERFACES | 声明类实现的接口 | class MyClass : public QObject { Q_INTERFACES(MyInterface) }; |
| Q_DECLARE_FLAGS | 声明基于枚举的标志类型 | Q_DECLARE_FLAGS(MyFlags, MyEnum) |
| Q_DECLARE_OPERATORS_FOR_FLAGS | 为标志类型声明运算符 | Q_DECLARE_OPERATORS_FOR_FLAGS(MyFlags) |
| QT_BEGIN_INCLUDE_NAMESPACE | 开始包含命名空间中的头文件 | QT_BEGIN_INCLUDE_NAMESPACE |
| QT_END_INCLUDE_NAMESPACE | 结束包含命名空间中的头文件 | QT_END_INCLUDE_NAMESPACE |
| QT_DEPRECATED | 标记已弃用的函数或类 | QT_DEPRECATED void oldFunction(); |
| QT_DEPRECATED_X | 带信息的弃用标记 | QT_DEPRECATED_X("Use newFunction instead") void oldFunction(); |